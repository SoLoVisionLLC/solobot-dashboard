                    <!-- =================== CHAT PAGE =================== -->
                    <div id="page-chat" class="page">
                        <div class="chat-page-wrapper">
                            <!-- Chat Actions Bar -->
                            <div class="chat-page-header">
                                <div class="chat-page-title">
                                    <span
                                        id="chat-page-agent-name"
                                        style="font-size: 14px; font-weight: 600; color: var(--text-primary)"
                                    ></span>
                                    <span
                                        id="chat-page-status-dot"
                                        class="status-dot idle"
                                    ></span>
                                    <span id="chat-page-status-text"
                                    >Disconnected</span>
                                </div>
                                <div class="chat-page-actions">
                                    <!-- Chat Search Input -->
                                    <div
                                        class="chat-search-wrapper"
                                        style="position: relative; display: flex; align-items: center;"
                                    >
                                        <input
                                            type="text"
                                            id="chat-search"
                                            placeholder="Search chat..."
                                            class="input chat-search-input"
                                            style="width: 180px; font-size: 12px; padding: 6px 10px 6px 28px; height: 32px; border-radius: 6px; transition: width 0.2s ease;"
                                            onfocus="this.style.width='240px'"
                                            onblur="this.style.width='180px'"
                                        >
                                        <span
                                            style="position: absolute; left: 8px; top: 50%; transform: translateY(-50%); font-size: 11px; opacity: 0.5; pointer-events: none;"
                                        >üîç</span>
                                    </div>
                                    <div
                                        class="session-selector-wrapper"
                                        style="position: relative; display: inline-flex; align-items: center; margin-right: 8px"
                                    >
                                        <span
                                            id="chat-page-session-name"
                                            style="font-size: 13px; color: var(--accent-color); font-weight: 600; background: var(--surface-elevated); padding: 4px 10px; border-radius: 6px; border: 1px solid var(--border-color)"
                                        >main</span>
                                        <button
                                            onclick="toggleChatPageSessionMenu()"
                                            class="btn btn-icon"
                                            style="padding: 4px; margin-left: 2px"
                                            title="Switch session"
                                        >
                                            <svg
                                                fill="none"
                                                stroke="currentColor"
                                                viewBox="0 0 24 24"
                                                style="width: 16px; height: 16px"
                                            >
                                                <path
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                    stroke-width="2"
                                                    d="M19 9l-7 7-7-7"
                                                >
                                                </path>
                                            </svg>
                                        </button>
                                        <div
                                            id="chat-page-session-menu"
                                            class="hidden session-dropdown-menu"
                                            style="max-height: 300px; overflow-y: auto"
                                        >
                                            <!-- Sessions populated dynamically -->
                                        </div>
                                    </div>
                                    <button
                                        onclick="clearChatHistory()"
                                        class="btn btn-ghost"
                                        title="Clear chat"
                                    >
                                        üóëÔ∏è
                                    </button>
                                </div>
                            </div>

                            <!-- Messages Area -->
                            <div
                                id="chat-page-messages"
                                class="chat-page-messages"
                            >
                                <!-- Messages rendered by JS -->
                            </div>

                            <!-- Floating scroll to bottom button -->
                            <button
                                id="scroll-to-bottom-btn"
                                class="scroll-to-bottom-btn hidden"
                                onclick="scrollChatToBottom()"
                                title="Scroll to latest"
                            >
                                ‚Üì
                            </button>

                            <!-- New message indicator (shown when scrolled up) -->
                            <div
                                id="chat-page-new-indicator"
                                class="chat-page-new-message-indicator hidden"
                                onclick="scrollChatToBottom()"
                            >
                                ‚Üì New messages
                            </div>

                            <!-- Fixed Input Area -->
                            <div class="chat-page-input-area">
                                <div class="chat-page-input-container">
                                    <!-- Image Preview (supports multiple) -->
                                    <div
                                        id="chat-page-image-preview"
                                        class="hidden image-preview-container"
                                    >
                                        <!-- Thumbnails rendered dynamically -->
                                    </div>

                                    <div class="chat-page-input-row">
                                        <input
                                            type="file"
                                            id="chat-page-image-upload"
                                            accept="image/*"
                                            multiple
                                            class="hidden"
                                            onchange="handleChatPageImageSelect(event)"
                                        >
                                        <button
                                            onclick="document.getElementById('chat-page-image-upload').click()"
                                            class="btn btn-ghost"
                                            title="Attach image"
                                        >
                                            üìé
                                        </button>
                                        <div class="voice-controls">
                                            <button
                                                id="voice-input-btn-chatpage"
                                                class="voice-btn"
                                                onclick="toggleVoiceInputChatPage()"
                                                title="Voice input (click to speak, or hold spacebar)"
                                            >
                                                <svg
                                                    id="voice-icon-mic-chatpage"
                                                    style="width: 20px; height: 20px"
                                                    fill="none"
                                                    stroke="currentColor"
                                                    viewBox="0 0 24 24"
                                                >
                                                    <path
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"
                                                    >
                                                    </path>
                                                </svg>
                                                <svg
                                                    id="voice-icon-stop-chatpage"
                                                    style="width: 20px; height: 20px; display: none"
                                                    fill="none"
                                                    stroke="currentColor"
                                                    viewBox="0 0 24 24"
                                                >
                                                    <path
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                                                    >
                                                    </path>
                                                    <path
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"
                                                    >
                                                    </path>
                                                </svg>
                                            </button>
                                            <button
                                                class="voice-auto-send-toggle"
                                                onclick="toggleVoiceAutoSend()"
                                                title="Auto-send OFF (click to enable)"
                                            >
                                                ‚ö°
                                            </button>
                                        </div>
                                        <!-- Hidden decoy fields to trick password managers -->
                                        <input
                                            type="text"
                                            name="fake_username_field"
                                            style="display: none"
                                            tabindex="-1"
                                            aria-hidden="true"
                                        >
                                        <input
                                            type="password"
                                            name="fake_password_field"
                                            style="display: none"
                                            tabindex="-1"
                                            aria-hidden="true"
                                        >
                                        <textarea
                                            id="chat-page-input"
                                            name="chat_message_input_field_"
                                            placeholder="Message SoLoBot..."
                                            onpaste="handleChatPagePaste(event)"
                                            autocomplete="off"
                                            autocorrect="off"
                                            autocapitalize="off"
                                            spellcheck="false"
                                            data-lpignore="true"
                                            data-form-type="other"
                                            data-1p-ignore="true"
                                            rows="1"
                                        ></textarea>
                                        <button
                                            onclick="sendChatPageMessage()"
                                            class="btn btn-primary"
                                        >
                                            Send
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- END CHAT PAGE -->
