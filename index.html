<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoLoVision Command Center</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ========================================
           DESIGN SYSTEM - SoLoVision Brand
           ======================================== */

        :root {
            /* Brand Colors */
            --brand-red: #BC2026;
            --brand-red-hover: #a51c21;
            --brand-navy: #1B2232;
            --brand-grey: #A9B2BC;
            --brand-white: #FFFFFF;

            /* Spacing Scale (8px base) */
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 12px;
            --space-4: 16px;
            --space-5: 20px;
            --space-6: 24px;
            --space-8: 32px;
            --space-10: 40px;
            --space-12: 48px;

            /* Border Radius */
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-full: 9999px;

            /* Transitions */
            --transition-fast: 150ms ease;
            --transition-normal: 200ms ease;
        }

        /* Dark Theme (Default) - Slate/metal cool grays */
        [data-theme="dark"] {
            /* Surfaces - slate grays with subtle cool undertone */
            --surface-base: #0c0d10;
            --surface-1: #14161a;
            --surface-2: #1c1e23;
            --surface-3: #24262c;
            --surface-overlay: #2c2f36;

            /* Text hierarchy */
            --text-primary: #FFFFFF;
            --text-secondary: #A9B2BC;
            --text-muted: rgba(169, 178, 188, 0.6);
            --text-faint: rgba(169, 178, 188, 0.4);

            /* Borders - subtle, not harsh */
            --border-default: rgba(169, 178, 188, 0.12);
            --border-subtle: rgba(169, 178, 188, 0.08);
            --border-strong: rgba(169, 178, 188, 0.2);
            --border-focus: rgba(188, 32, 38, 0.5);

            /* Controls */
            --control-bg: #1B2232;
            --control-border: rgba(169, 178, 188, 0.2);
            --control-focus: rgba(188, 32, 38, 0.3);

            /* Semantic */
            --success: #22c55e;
            --success-muted: rgba(34, 197, 94, 0.15);
            --warning: #eab308;
            --warning-muted: rgba(234, 179, 8, 0.15);
            --error: #ef4444;
            --error-muted: rgba(239, 68, 68, 0.15);

            /* Scrollbar */
            --scrollbar-track: var(--surface-1);
            --scrollbar-thumb: var(--brand-grey);
        }

        /* Light Theme */
        [data-theme="light"] {
            /* Surfaces */
            --surface-base: #F8FAFC;
            --surface-1: #FFFFFF;
            --surface-2: #F1F5F9;
            --surface-3: #E2E8F0;
            --surface-overlay: #FFFFFF;

            /* Text hierarchy */
            --text-primary: #1B2232;
            --text-secondary: #64748b;
            --text-muted: rgba(27, 34, 50, 0.5);
            --text-faint: rgba(27, 34, 50, 0.3);

            /* Borders */
            --border-default: rgba(27, 34, 50, 0.1);
            --border-subtle: rgba(27, 34, 50, 0.06);
            --border-strong: rgba(27, 34, 50, 0.15);
            --border-focus: rgba(188, 32, 38, 0.4);

            /* Controls */
            --control-bg: #FFFFFF;
            --control-border: rgba(27, 34, 50, 0.15);
            --control-focus: rgba(188, 32, 38, 0.2);

            /* Semantic - slightly adjusted for light bg */
            --success: #16a34a;
            --success-muted: rgba(22, 163, 74, 0.1);
            --warning: #ca8a04;
            --warning-muted: rgba(202, 138, 4, 0.1);
            --error: #dc2626;
            --error-muted: rgba(220, 38, 38, 0.1);

            /* Scrollbar */
            --scrollbar-track: var(--surface-2);
            --scrollbar-thumb: var(--brand-grey);
        }

        /* ========================================
           BASE STYLES
           ======================================== */

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--surface-base);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--scrollbar-track); }
        ::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }

        /* ========================================
           COMPONENTS
           ======================================== */

        /* Card */
        .card {
            background: var(--surface-1);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
        }

        .card-elevated {
            background: var(--surface-2);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all var(--transition-fast);
        }

        .btn-primary {
            background: var(--brand-red);
            color: white;
        }
        .btn-primary:hover {
            background: var(--brand-red-hover);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-default);
        }
        .btn-ghost:hover {
            background: var(--surface-2);
            color: var(--text-primary);
            border-color: var(--border-strong);
        }

        .btn-icon {
            padding: var(--space-2);
            background: transparent;
            color: var(--text-secondary);
            border: none;
            border-radius: var(--radius-md);
        }
        .btn-icon:hover {
            background: var(--surface-2);
            color: var(--text-primary);
        }

        /* Inputs */
        .input {
            width: 100%;
            padding: var(--space-2) var(--space-3);
            background: var(--control-bg);
            border: 1px solid var(--control-border);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 14px;
            transition: border-color var(--transition-fast);
        }
        .input::placeholder {
            color: var(--text-muted);
        }
        .input:focus {
            outline: none;
            border-color: var(--brand-red);
            box-shadow: 0 0 0 3px var(--control-focus);
        }

        /* Badge */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 2px var(--space-2);
            border-radius: var(--radius-full);
            font-size: 11px;
            font-weight: 500;
        }
        .badge-default {
            background: var(--surface-3);
            color: var(--text-secondary);
        }
        .badge-success {
            background: var(--success-muted);
            color: var(--success);
        }
        .badge-warning {
            background: var(--warning-muted);
            color: var(--warning);
        }
        .badge-error {
            background: var(--error-muted);
            color: var(--error);
        }

        /* Status dot */
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        .status-dot.success { background: var(--success); }
        .status-dot.warning { background: var(--warning); }
        .status-dot.error { background: var(--error); }
        .status-dot.idle { background: var(--text-muted); }
        .status-dot.pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Section heading */
        .section-title {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-4);
        }
        .section-title svg {
            width: 18px;
            height: 18px;
            color: var(--brand-red);
        }

        /* ========================================
           LAYOUT
           ======================================== */

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 var(--space-6);
        }

        /* Header */
        .header {
            background: var(--surface-1);
            border-bottom: 1px solid var(--border-default);
            padding: var(--space-4) 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.02em;
        }

        .header-status {
            display: flex;
            align-items: center;
            gap: var(--space-6);
        }

        .status-chip {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-3);
            background: var(--surface-2);
            border-radius: var(--radius-md);
            font-size: 13px;
            font-weight: 500;
        }

        .header-meta {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            font-size: 13px;
            color: var(--text-secondary);
        }
        .header-meta span {
            color: var(--text-primary);
        }

        /* Theme toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2);
            background: var(--surface-2);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            cursor: pointer;
        }
        .theme-toggle:hover {
            border-color: var(--border-strong);
        }
        .theme-toggle svg {
            width: 18px;
            height: 18px;
            color: var(--text-secondary);
        }
        .theme-toggle:hover svg {
            color: var(--text-primary);
        }

        /* Main content */
        .main {
            padding: var(--space-6) 0;
        }

        /* Grid layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-6);
        }
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-4);
        }
        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-4);
        }

        @media (max-width: 1024px) {
            .grid-2 { grid-template-columns: 1fr; }
            .grid-4 { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) {
            .grid-3 { grid-template-columns: 1fr; }
            .grid-4 { grid-template-columns: 1fr; }
        }

        /* Section spacing */
        .section {
            margin-bottom: var(--space-8);
        }

        /* ========================================
           TASK BOARD
           ======================================== */

        .board-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .board-actions {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .column {
            background: var(--surface-1);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            min-height: 300px;
        }

        .column-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .column-title {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: 14px;
            font-weight: 600;
        }

        .drop-zone {
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            overscroll-behavior: contain;
            border-radius: var(--radius-md);
            transition: background var(--transition-fast);
        }
        .drop-zone.drag-over {
            background: var(--surface-2);
        }

        .task-card {
            background: var(--surface-2);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            padding: var(--space-3);
            margin-bottom: var(--space-2);
            cursor: grab;
            transition: all var(--transition-fast);
            position: relative;
        }
        .task-card:hover {
            border-color: var(--border-strong);
        }
        .task-card:active {
            cursor: grabbing;
        }

        .task-card.selected {
            border-color: var(--brand-red);
            box-shadow: 0 0 0 2px var(--control-focus);
        }

        .priority-p0 { border-left: 3px solid var(--brand-red); }
        .priority-p1 { border-left: 3px solid var(--warning); }
        .priority-p2 { border-left: 3px solid #3b82f6; }

        .task-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: var(--space-1);
        }

        .task-meta {
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Quick actions on hover */
        .task-quick-actions {
            position: absolute;
            right: var(--space-2);
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            transition: opacity var(--transition-fast);
        }
        .task-card:hover .task-quick-actions {
            opacity: 1;
        }

        /* ========================================
           TERMINAL
           ======================================== */

        .terminal {
            background: #0d1117;
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .terminal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-3) var(--space-4);
            background: var(--surface-2);
            border-bottom: 1px solid var(--border-default);
        }

        .terminal-dots {
            display: flex;
            gap: 6px;
        }
        .terminal-dots span {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .terminal-dots .red { background: #ff5f56; }
        .terminal-dots .yellow { background: #ffbd2e; }
        .terminal-dots .green { background: #27c93f; }

        .terminal-title {
            font-family: 'Fira Code', 'Monaco', monospace;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .terminal-output {
            padding: var(--space-4);
            font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.6;
            height: 250px;
            overflow-y: auto;
            overscroll-behavior: contain;
            color: var(--text-secondary);
        }
        .terminal-output .cmd { color: #7ee787; }
        .terminal-output .info { color: var(--text-muted); }
        .terminal-output .error { color: #f85149; }

        /* ========================================
           CHAT
           ======================================== */

        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .chat-header {
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-default);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-messages {
            flex: 1;
            min-height: 300px;
            max-height: 350px;
            overflow-y: auto;
            padding: var(--space-4);
            background: var(--surface-base);
            overscroll-behavior: contain;
        }

        .chat-input-area {
            padding: var(--space-3);
            border-top: 1px solid var(--border-default);
            display: flex;
            gap: var(--space-2);
            align-items: center;
        }

        /* Image preview */
        .image-preview-container {
            padding: var(--space-2) var(--space-3);
            border-top: 1px solid var(--border-default);
            display: none;
        }
        .image-preview-container.visible {
            display: block;
        }
        .image-preview-wrapper {
            position: relative;
            display: inline-block;
        }
        .image-preview-wrapper img {
            max-height: 80px;
            border-radius: var(--radius-md);
        }
        .image-preview-close {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: var(--brand-red);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ========================================
           ACTIVITY LOG
           ======================================== */

        .activity-list {
            height: 250px;
            overflow-y: auto;
            overscroll-behavior: contain;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
            padding: var(--space-2) 0;
            border-bottom: 1px solid var(--border-subtle);
        }
        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-time {
            font-size: 11px;
            color: var(--text-muted);
            white-space: nowrap;
            min-width: 60px;
        }

        .activity-text {
            font-size: 13px;
            color: var(--text-secondary);
        }
        .activity-text.success { color: var(--success); }
        .activity-text.warning { color: var(--warning); }

        /* ========================================
           NOTES
           ======================================== */

        .notes-input {
            display: flex;
            gap: var(--space-2);
            margin-bottom: var(--space-4);
        }

        .notes-list {
            height: 200px;
            overflow-y: auto;
            overscroll-behavior: contain;
        }

        .note-item {
            padding: var(--space-3);
            background: var(--surface-2);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-2);
        }

        .note-text {
            font-size: 13px;
            color: var(--text-primary);
            margin-bottom: var(--space-1);
        }

        .note-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-muted);
        }

        /* ========================================
           PRODUCT STATUS
           ======================================== */

        .product-card {
            background: var(--surface-1);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
        }

        .product-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-2);
        }

        .product-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .product-desc {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: var(--space-2);
        }

        .product-meta {
            font-size: 11px;
            color: var(--text-muted);
        }

        /* ========================================
           DOCS HUB
           ======================================== */

        .docs-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .docs-search {
            width: 200px;
        }

        .doc-card {
            display: block;
            background: var(--surface-1);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            transition: border-color var(--transition-fast);
            text-decoration: none;
            overflow: hidden;
        }
        .doc-card:hover {
            border-color: var(--border-strong);
        }
        .doc-card * {
            max-width: 100%;
        }

        .doc-icon {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .doc-icon.gdoc { background: rgba(66, 133, 244, 0.15); color: #4285f4; }
        .doc-icon.gsheet { background: rgba(52, 168, 83, 0.15); color: #34a853; }
        .doc-icon.pdf { background: rgba(234, 67, 53, 0.15); color: #ea4335; }
        .doc-icon.default { background: var(--surface-3); color: var(--text-secondary); }

        .doc-title {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .doc-meta {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* ========================================
           MODALS
           ======================================== */

        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: var(--space-4);
        }
        .modal-overlay.visible {
            display: flex;
        }

        .modal {
            background: var(--surface-1);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            width: 100%;
            max-width: 480px;
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal-lg {
            max-width: 640px;
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: var(--space-1);
        }
        .modal-close:hover {
            color: var(--text-primary);
        }

        .modal-section {
            margin-bottom: var(--space-6);
        }

        .modal-section-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-3);
        }

        .modal-section-content {
            background: var(--surface-2);
            border-radius: var(--radius-md);
            padding: var(--space-4);
        }

        .form-group {
            margin-bottom: var(--space-3);
        }
        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-label {
            display: block;
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: var(--space-1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-3);
        }

        .form-actions {
            display: flex;
            gap: var(--space-2);
            margin-top: var(--space-4);
        }
        .form-actions .btn {
            flex: 1;
        }

        /* Settings row */
        .setting-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-3) 0;
            border-bottom: 1px solid var(--border-subtle);
        }
        .setting-row:last-child {
            border-bottom: none;
        }

        .setting-info {
            flex: 1;
        }

        .setting-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .setting-desc {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Select styling */
        .select {
            padding: var(--space-2) var(--space-3);
            background: var(--control-bg);
            border: 1px solid var(--control-border);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 13px;
            cursor: pointer;
        }
        .select:focus {
            outline: none;
            border-color: var(--brand-red);
        }

        /* Toggle switch */
        .toggle {
            position: relative;
            width: 44px;
            height: 24px;
        }
        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            inset: 0;
            background: var(--surface-3);
            border-radius: var(--radius-full);
            transition: background var(--transition-fast);
        }
        .toggle-slider::before {
            content: '';
            position: absolute;
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background: white;
            border-radius: 50%;
            transition: transform var(--transition-fast);
        }
        .toggle input:checked + .toggle-slider {
            background: var(--brand-red);
        }
        .toggle input:checked + .toggle-slider::before {
            transform: translateX(20px);
        }

        /* Danger zone */
        .danger-zone {
            background: var(--error-muted);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: var(--radius-md);
            padding: var(--space-4);
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }
        .btn-danger:hover {
            background: #dc2626;
        }

        /* ========================================
           FOOTER
           ======================================== */

        .footer {
            background: var(--surface-1);
            border-top: 1px solid var(--border-default);
            padding: var(--space-3) 0;
            margin-top: var(--space-8);
        }

        .footer-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-muted);
        }

        .footer-status {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-1);
            color: var(--success);
        }

        /* ========================================
           BULK ACTIONS BAR
           ======================================== */

        .bulk-action-bar {
            position: fixed;
            bottom: var(--space-6);
            left: 50%;
            transform: translateX(-50%);
            background: var(--surface-overlay);
            border: 1px solid var(--border-strong);
            border-radius: var(--radius-lg);
            padding: var(--space-3) var(--space-4);
            display: none;
            align-items: center;
            gap: var(--space-4);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 50;
            animation: slideUp 0.2s ease;
        }
        .bulk-action-bar.visible {
            display: flex;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translate(-50%, 20px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }

        /* ========================================
           UTILITIES
           ======================================== */

        .hidden { display: none !important; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-1 { gap: var(--space-1); }
        .gap-2 { gap: var(--space-2); }
        .gap-3 { gap: var(--space-3); }
        .gap-4 { gap: var(--space-4); }
        .flex-1 { flex: 1; }
        .text-center { text-align: center; }
        .truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .space-y-2 > * + * { margin-top: var(--space-2); }
        .space-y-3 > * + * { margin-top: var(--space-3); }
        
        /* ========================================
           SIDEBAR LAYOUT
           ======================================== */
        
        .app-layout {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 64px;
            background: var(--surface-1);
            border-right: 1px solid var(--border-default);
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 100;
            transition: width var(--transition-normal);
        }
        
        .sidebar:hover {
            width: 200px;
        }
        
        .sidebar-logo {
            padding: var(--space-4);
            border-bottom: 1px solid var(--border-default);
            display: flex;
            align-items: center;
            gap: var(--space-3);
            height: 60px;
        }
        
        .sidebar-logo-icon {
            width: 32px;
            height: 32px;
            background: var(--brand-red);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }
        
        .sidebar-logo-text {
            font-weight: 600;
            font-size: 14px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .sidebar:hover .sidebar-logo-text {
            opacity: 1;
        }
        
        .sidebar-nav {
            flex: 1;
            padding: var(--space-3);
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }
        
        .sidebar-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
        }
        
        .sidebar-item:hover {
            background: var(--surface-2);
            color: var(--text-primary);
        }
        
        .sidebar-item.active {
            background: var(--brand-red);
            color: white;
        }
        
        .sidebar-item-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .sidebar-item-text {
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .sidebar:hover .sidebar-item-text {
            opacity: 1;
        }
        
        .sidebar-footer {
            padding: var(--space-3);
            border-top: 1px solid var(--border-default);
        }
        
        .app-content {
            flex: 1;
            margin-left: 64px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        /* Page containers */
        .page {
            display: none;
            flex: 1;
        }
        
        .page.active {
            display: block;
        }
        
        /* Memory page specific styles */
        .memory-page {
            padding: var(--space-6);
        }
        
        .memory-page .page-header {
            margin-bottom: var(--space-6);
        }
        
        .memory-page .page-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .memory-page .page-subtitle {
            color: var(--text-secondary);
            margin-top: var(--space-2);
        }
        
        .memory-search-bar {
            display: flex;
            gap: var(--space-3);
            margin-bottom: var(--space-6);
        }
        
        .memory-search-bar input {
            flex: 1;
            max-width: 400px;
        }
        
        .sync-status {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: 13px;
            color: var(--text-muted);
        }
        
        .sync-status.syncing {
            color: var(--warning);
        }
        
        .sync-status.synced {
            color: var(--success);
        }
    </style>
</head>
<body>

    <!-- App Layout with Sidebar -->
    <div class="app-layout">
    
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-logo">
            <div class="sidebar-logo-icon">SV</div>
            <span class="sidebar-logo-text">SoLoVision</span>
        </div>
        
        <nav class="sidebar-nav">
            <a class="sidebar-item active" onclick="showPage('dashboard')" data-page="dashboard">
                <span class="sidebar-item-icon">üè†</span>
                <span class="sidebar-item-text">Dashboard</span>
            </a>
            <a class="sidebar-item" onclick="showPage('memory')" data-page="memory">
                <span class="sidebar-item-icon">üß†</span>
                <span class="sidebar-item-text">Memory</span>
            </a>
            <a class="sidebar-item" onclick="showPage('chat')" data-page="chat">
                <span class="sidebar-item-icon">üí¨</span>
                <span class="sidebar-item-text">Chat</span>
            </a>
            <a class="sidebar-item" onclick="showPage('products')" data-page="products">
                <span class="sidebar-item-icon">üì¶</span>
                <span class="sidebar-item-text">Products</span>
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <a class="sidebar-item" onclick="openSettingsModal()">
                <span class="sidebar-item-icon">‚öôÔ∏è</span>
                <span class="sidebar-item-text">Settings</span>
            </a>
        </div>
    </aside>
    
    <!-- Main App Content -->
    <div class="app-content">
    
    <!-- Header -->
    <header class="header">
        <div class="container header-inner">
            <div class="logo">Command Center</div>

            <div class="header-status">
                <div class="status-chip">
                    <div id="status-indicator" class="status-dot success pulse"></div>
                    <span id="status-text">IDLE</span>
                </div>

                <div class="header-meta">
                    <div>Provider: <span id="provider-name">anthropic</span></div>
                    <div>Model: <span id="model-name">opus 4.5</span></div>
                </div>

                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <svg id="theme-icon-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                    </svg>
                    <svg id="theme-icon-light" class="hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Sub-agent Banner -->
    <div id="subagent-banner" class="hidden" style="background: var(--warning-muted); border-bottom: 1px solid var(--border-default); padding: var(--space-2) 0;">
        <div class="container flex items-center gap-2" style="font-size: 13px;">
            <svg class="animate-spin" style="width: 16px; height: 16px; color: var(--warning);" fill="none" viewBox="0 0 24 24">
                <circle style="opacity: 0.25;" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path style="opacity: 0.75;" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span style="color: var(--warning); font-weight: 500;">Sub-agent active:</span>
            <span id="subagent-task">Researching...</span>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main">
        
        <!-- =================== DASHBOARD PAGE =================== -->
        <div id="page-dashboard" class="page active">
        <div class="container">

            <!-- Task Board -->
            <section class="section">
                <div class="board-header">
                    <h2 class="section-title">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        Task Board
                    </h2>
                    <div class="board-actions">
                        <button onclick="openArchiveModal()" class="btn btn-ghost">
                            <span>üì¶</span> Archive
                            <span id="archive-badge" class="badge badge-error hidden">0</span>
                        </button>
                        <button onclick="syncFromVPS()" class="btn btn-ghost" title="Pull latest state from VPS">
                            <span>üîÑ</span> Sync
                        </button>
                        <button onclick="openSettingsModal()" class="btn btn-ghost">
                            <span>‚öôÔ∏è</span> Settings
                        </button>
                    </div>
                </div>

                <div class="grid-3">
                    <!-- To-Do Column -->
                    <div class="column">
                        <div class="column-header">
                            <h3 class="column-title">
                                <span class="status-dot idle"></span>
                                To-Do
                                <span id="todo-count" class="badge badge-default">0</span>
                            </h3>
                            <button onclick="openAddTask('todo')" class="btn-icon" title="Add task">
                                <svg style="width: 18px; height: 18px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                </svg>
                            </button>
                        </div>
                        <div id="todo-tasks" class="drop-zone space-y-2"
                             ondragover="handleDragOver(event)"
                             ondragenter="handleDragEnter(event, 'todo')"
                             ondragleave="handleDragLeave(event, 'todo')"
                             ondrop="handleDrop(event, 'todo')">
                        </div>
                    </div>

                    <!-- In Progress Column -->
                    <div class="column">
                        <div class="column-header">
                            <h3 class="column-title">
                                <span class="status-dot warning"></span>
                                In Progress
                                <span id="progress-count" class="badge badge-default">0</span>
                            </h3>
                        </div>
                        <div id="progress-tasks" class="drop-zone space-y-2"
                             ondragover="handleDragOver(event)"
                             ondragenter="handleDragEnter(event, 'progress')"
                             ondragleave="handleDragLeave(event, 'progress')"
                             ondrop="handleDrop(event, 'progress')">
                        </div>
                    </div>

                    <!-- Done Column -->
                    <div class="column">
                        <div class="column-header">
                            <h3 class="column-title">
                                <span class="status-dot success"></span>
                                Done
                                <span id="done-count" class="badge badge-default">0</span>
                            </h3>
                            <button onclick="clearDone()" class="btn-icon" title="Clear done" style="font-size: 12px; color: var(--text-muted);">
                                Clear
                            </button>
                        </div>
                        <div id="done-tasks" class="drop-zone space-y-2"
                             ondragover="handleDragOver(event)"
                             ondragenter="handleDragEnter(event, 'done')"
                             ondragleave="handleDragLeave(event, 'done')"
                             ondrop="handleDrop(event, 'done')">
                        </div>
                    </div>
                </div>
            </section>

            <!-- Terminal + Activity -->
            <section class="section">
                <div class="grid-2">
                    <!-- Terminal -->
                    <div class="terminal" id="console-section">
                        <div class="terminal-header">
                            <div class="flex items-center gap-3">
                                <div class="terminal-dots">
                                    <span class="red"></span>
                                    <span class="yellow"></span>
                                    <span class="green"></span>
                                </div>
                                <span class="terminal-title">SoLoBot Terminal</span>
                                <span id="console-status-badge" class="badge badge-success">IDLE</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <button onclick="clearConsole()" class="btn-icon" style="font-size: 12px;">Clear</button>
                                <button onclick="toggleConsoleExpand()" class="btn-icon" style="font-size: 12px;" id="console-expand-btn">Expand</button>
                            </div>
                        </div>
                        <div id="console-output" class="terminal-output">
                            <div class="cmd">$ solobot --init</div>
                            <div class="info">Ready for commands...</div>
                        </div>
                    </div>

                    <!-- Activity Log -->
                    <div class="card" style="padding: var(--space-4);">
                        <h2 class="section-title" style="margin-bottom: var(--space-3);">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            Activity Log
                        </h2>
                        <div id="activity-log" class="activity-list">
                        </div>
                    </div>
                </div>
            </section>

            <!-- Chat + Notes -->
            <section class="section">
                <div class="grid-2">
                    <!-- Chat -->
                    <div class="card chat-container">
                        <div class="chat-header">
                            <h2 class="section-title" style="margin-bottom: 0;">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                </svg>
                                Chat with SoLoBot
                            </h2>
                            <div class="flex items-center gap-2">
                                <span id="gateway-status-dot" class="status-dot idle"></span>
                                <span id="gateway-status" style="font-size: 12px; color: var(--text-muted);">Disconnected</span>
                            </div>
                        </div>

                        <div id="chat-messages" class="chat-messages">
                            <div style="color: var(--text-muted); font-size: 13px; text-align: center; padding: var(--space-8) 0;">
                                üîå Connect to Gateway in Settings to start chatting
                            </div>
                        </div>

                        <!-- Image Preview -->
                        <div id="image-preview-container" class="image-preview-container">
                            <div class="image-preview-wrapper">
                                <img id="image-preview" />
                                <button onclick="clearImagePreview()" class="image-preview-close">‚úï</button>
                            </div>
                        </div>

                        <div class="chat-input-area">
                            <label class="btn-icon" style="cursor: pointer;">
                                <input type="file" id="image-upload" accept="image/*" class="hidden" onchange="handleImageSelect(event)">
                                <svg style="width: 20px; height: 20px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                            </label>
                            <input type="text" id="chat-input" class="input flex-1" placeholder="Type a message..."
                                   onkeypress="if(event.key==='Enter')sendChatMessage()"
                                   onpaste="handlePaste(event)">
                            <button onclick="sendChatMessage()" class="btn btn-primary">Send</button>
                        </div>
                    </div>

                    <!-- Notes -->
                    <div class="card" style="padding: var(--space-4);">
                        <h2 class="section-title" style="margin-bottom: var(--space-3);">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                            Notes for SoLoBot
                        </h2>
                        <div class="notes-input">
                            <input type="text" id="note-input" class="input flex-1" placeholder="Leave a note for SoLoBot...">
                            <button onclick="addNote()" class="btn btn-primary">Send</button>
                        </div>
                        <div id="notes-list" class="notes-list">
                        </div>
                    </div>
                </div>
            </section>

            <!-- Product Status -->
            <section class="section">
                <h2 class="section-title">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                    </svg>
                    Product Status
                </h2>
                <div class="grid-4">
                    <div class="product-card">
                        <div class="product-header">
                            <span class="product-name">SoLoLink</span>
                            <span class="status-dot success"></span>
                        </div>
                        <p class="product-desc">Link/widget tool</p>
                        <p class="product-meta">Last update: Active</p>
                    </div>
                    <div class="product-card">
                        <div class="product-header">
                            <span class="product-name">SoLoRecall</span>
                            <span class="status-dot warning"></span>
                        </div>
                        <p class="product-desc">AI productivity app</p>
                        <p class="product-meta">Last update: In dev</p>
                    </div>
                    <div class="product-card">
                        <div class="product-header">
                            <span class="product-name">SoLoVoice</span>
                            <span class="status-dot success"></span>
                        </div>
                        <p class="product-desc">Voice/audio tool</p>
                        <p class="product-meta">Last update: Active</p>
                    </div>
                    <div class="product-card">
                        <div class="product-header">
                            <span class="product-name">SoLoFamilyPlan</span>
                            <span class="status-dot success"></span>
                        </div>
                        <p class="product-desc">Family organizer</p>
                        <p class="product-meta">Last update: Stable</p>
                    </div>
                    <div class="product-card">
                        <div class="product-header">
                            <span class="product-name">SoLoStandBy</span>
                            <span class="status-dot warning"></span>
                        </div>
                        <p class="product-desc">StandBy mode for Android</p>
                        <p class="product-meta">Last update: In Review</p>
                    </div>
                </div>
            </section>

        </div>
        </div>
        <!-- END DASHBOARD PAGE -->
        
        <!-- =================== MEMORY PAGE =================== -->
        <div id="page-memory" class="page">
            <div class="memory-page">
                <div class="page-header">
                    <h1 class="page-title">
                        üß† Memory Files
                    </h1>
                    <p class="page-subtitle">
                        These are SoLoBot's live memory files. Edit them here and they'll sync back to the workspace.
                    </p>
                </div>
                
                <div class="memory-search-bar">
                    <input type="text" id="memory-search" class="input" placeholder="Search memory files..." oninput="renderMemoryFiles(this.value)">
                    <button class="btn btn-secondary" onclick="syncMemoryFilesNow()">
                        üîÑ Sync Now
                    </button>
                    <div id="sync-status" class="sync-status">
                        <span class="status-dot success"></span>
                        Last synced: <span id="last-memory-sync">--</span>
                    </div>
                </div>
                
                <div id="memory-files-grid" class="docs-grid">
                    <!-- Memory files will be rendered here -->
                </div>
            </div>
        </div>
        <!-- END MEMORY PAGE -->
        
        <!-- =================== CHAT PAGE =================== -->
        <div id="page-chat" class="page">
            <div class="container" style="padding: var(--space-6); max-width: 900px;">
                <div class="page-header" style="margin-bottom: var(--space-6);">
                    <h1 class="page-title" style="font-size: 24px; font-weight: 700;">
                        üí¨ Chat with SoLoBot
                    </h1>
                    <p class="page-subtitle" style="color: var(--text-secondary); margin-top: var(--space-2);">
                        Full conversation view
                    </p>
                </div>
                <div id="chat-page-container">
                    <!-- Chat will be rendered here when page is active -->
                    <p style="color: var(--text-muted);">Chat functionality coming soon. Use the chat widget on the Dashboard for now.</p>
                </div>
            </div>
        </div>
        <!-- END CHAT PAGE -->
        
        <!-- =================== PRODUCTS PAGE =================== -->
        <div id="page-products" class="page">
            <div class="container" style="padding: var(--space-6);">
                <div class="page-header" style="margin-bottom: var(--space-6);">
                    <h1 class="page-title" style="font-size: 24px; font-weight: 700;">
                        üì¶ SoLoVision Products
                    </h1>
                    <p class="page-subtitle" style="color: var(--text-secondary); margin-top: var(--space-2);">
                        Manage and monitor all SoLoVision products
                    </p>
                </div>
                <div id="products-page-grid" class="grid-3">
                    <!-- Products will be rendered here -->
                    <p style="color: var(--text-muted);">Expanded product management coming soon.</p>
                </div>
            </div>
        </div>
        <!-- END PRODUCTS PAGE -->

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container footer-inner">
            <span>SoLoVision LLC ¬© 2026</span>
            <div class="footer-status">
                <div class="live-indicator">
                    <span class="status-dot success pulse"></span>
                    <span>LIVE</span>
                </div>
                <span>Last sync: <span id="last-sync">--:--</span></span>
            </div>
        </div>
    </footer>

    <!-- Bulk Action Bar -->
    <div id="bulk-action-bar" class="bulk-action-bar">
        <span id="bulk-count" style="font-size: 13px; font-weight: 500;">0 selected</span>
        <button onclick="bulkMoveTo('todo')" class="btn btn-ghost">‚Üí To-Do</button>
        <button onclick="bulkMoveTo('progress')" class="btn btn-ghost">‚Üí In Progress</button>
        <button onclick="bulkMoveTo('done')" class="btn btn-ghost">‚Üí Done</button>
        <button onclick="bulkMoveTo('archive')" class="btn btn-ghost">üì¶ Archive</button>
        <button onclick="clearSelection()" class="btn-icon">‚úï</button>
    </div>

    <!-- Add Task Modal -->
    <div id="add-task-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add New Task</h3>
                <button onclick="closeAddTask()" class="modal-close">‚úï</button>
            </div>
            <input type="text" id="new-task-title" class="input" placeholder="Task title..." style="margin-bottom: var(--space-4);">
            <div class="flex gap-2" style="margin-bottom: var(--space-4);">
                <button onclick="setTaskPriority(0)" id="priority-btn-0" class="btn btn-ghost flex-1" style="border-color: var(--brand-red); color: var(--brand-red);">P0</button>
                <button onclick="setTaskPriority(1)" id="priority-btn-1" class="btn btn-ghost flex-1" style="border-color: var(--warning); color: var(--warning);">P1</button>
                <button onclick="setTaskPriority(2)" id="priority-btn-2" class="btn btn-ghost flex-1" style="border-color: #3b82f6; color: #3b82f6;">P2</button>
            </div>
            <div class="form-actions">
                <button onclick="closeAddTask()" class="btn btn-ghost">Cancel</button>
                <button onclick="submitTask()" class="btn btn-primary">Add Task</button>
            </div>
        </div>
    </div>

    <!-- Task Action Modal -->
    <div id="task-action-modal" class="modal-overlay">
        <div class="modal" style="max-width: 360px;">
            <div class="modal-header">
                <div>
                    <h3 class="modal-title">Task Actions</h3>
                    <p id="action-modal-task-title" style="font-size: 13px; color: var(--text-muted); margin-top: var(--space-1); max-width: 250px;" class="truncate"></p>
                </div>
                <button onclick="closeActionModal()" class="modal-close">‚úï</button>
            </div>

            <div class="space-y-2" style="margin-bottom: var(--space-4);">
                <button id="action-move-todo" onclick="modalMoveTask('todo')" class="btn btn-ghost" style="width: 100%; justify-content: flex-start;">
                    <span class="status-dot idle"></span> Move to To-Do
                </button>
                <button id="action-move-progress" onclick="modalMoveTask('progress')" class="btn btn-ghost" style="width: 100%; justify-content: flex-start;">
                    <span class="status-dot warning"></span> Move to In Progress
                </button>
                <button id="action-move-done" onclick="modalMoveTask('done')" class="btn btn-ghost" style="width: 100%; justify-content: flex-start;">
                    <span class="status-dot success"></span> Move to Done
                </button>
                <button id="action-move-archive" onclick="modalMoveTask('archive')" class="btn btn-ghost" style="width: 100%; justify-content: flex-start;">
                    üì¶ Archive
                </button>
            </div>

            <div style="border-top: 1px solid var(--border-default); padding-top: var(--space-4);" class="space-y-2">
                <button onclick="modalEditTitle()" class="btn btn-ghost" style="width: 100%; justify-content: flex-start;">
                    ‚úèÔ∏è Edit Title
                </button>
                <button onclick="modalCyclePriority()" class="btn btn-ghost" style="width: 100%; justify-content: flex-start;">
                    üîÑ <span id="action-priority-text">Change Priority (P1)</span>
                </button>
            </div>

            <div style="border-top: 1px solid var(--border-default); padding-top: var(--space-4); margin-top: var(--space-4);">
                <button onclick="modalDeleteTask()" class="btn btn-ghost" style="width: 100%; justify-content: flex-start; color: var(--error);">
                    üóëÔ∏è Delete Task
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Title Modal -->
    <div id="edit-title-modal" class="modal-overlay">
        <div class="modal" style="max-width: 360px;">
            <div class="modal-header">
                <h3 class="modal-title">Edit Task Title</h3>
                <button onclick="closeEditTitleModal()" class="modal-close">‚úï</button>
            </div>
            <input type="text" id="edit-title-input" class="input" placeholder="Task title..." style="margin-bottom: var(--space-4);">
            <div class="form-actions">
                <button onclick="closeEditTitleModal()" class="btn btn-ghost">Cancel</button>
                <button onclick="saveEditedTitle()" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete Modal -->
    <div id="confirm-delete-modal" class="modal-overlay">
        <div class="modal" style="max-width: 360px;">
            <div class="modal-header">
                <h3 class="modal-title">Delete Task?</h3>
                <button onclick="closeDeleteModal()" class="modal-close">‚úï</button>
            </div>
            <p id="delete-modal-task-title" style="font-size: 13px; color: var(--text-muted); margin-bottom: var(--space-4);" class="truncate"></p>
            <div class="form-actions">
                <button onclick="closeDeleteModal()" class="btn btn-ghost">Cancel</button>
                <button onclick="confirmDeleteTask()" class="btn btn-danger">Delete</button>
            </div>
        </div>
    </div>

    <!-- Memory File Viewer Modal -->
    <div id="memory-file-modal" class="modal-overlay">
        <div class="modal modal-lg" style="max-width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title" id="memory-file-title">Memory File</h3>
                <button onclick="hideModal('memory-file-modal')" class="modal-close">‚úï</button>
            </div>
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <pre id="memory-file-content" style="font-family: 'SF Mono', 'Monaco', 'Consolas', monospace; font-size: 13px; line-height: 1.5; white-space: pre-wrap; word-wrap: break-word;">Loading...</pre>
            </div>
            <div class="modal-footer">
                <button onclick="hideModal('memory-file-modal')" class="btn btn-secondary">Close</button>
                <button onclick="editMemoryFile()" class="btn btn-primary">‚úèÔ∏è Edit</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal-overlay">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h3 class="modal-title">‚öôÔ∏è Dashboard Settings</h3>
                <button onclick="closeSettingsModal()" class="modal-close">‚úï</button>
            </div>

            <!-- Gateway Connection -->
            <div class="modal-section">
                <h4 class="modal-section-title">üîå Gateway Connection</h4>
                <div class="modal-section-content">
                    <div class="flex items-center gap-2" style="margin-bottom: var(--space-3);">
                        <span id="settings-gateway-dot" class="status-dot idle"></span>
                        <span id="settings-gateway-status" style="font-size: 13px; color: var(--text-muted);">Disconnected</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Gateway Host</label>
                        <input type="text" id="gateway-host" class="input" placeholder="e.g., moltbot.local or 192.168.1.100">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Port</label>
                            <input type="number" id="gateway-port" class="input" placeholder="443" value="443">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Session Key</label>
                            <input type="text" id="gateway-session" class="input" placeholder="main" value="main">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Token (optional)</label>
                        <input type="password" id="gateway-token" class="input" placeholder="Gateway auth token">
                    </div>
                    <div class="form-actions" style="margin-top: var(--space-3);">
                        <button id="gateway-connect-btn" onclick="connectToGateway()" class="btn btn-primary" style="background: var(--success);">Connect</button>
                        <button id="gateway-disconnect-btn" onclick="disconnectFromGateway()" class="btn btn-danger hidden">Disconnect</button>
                    </div>
                    <p style="font-size: 12px; color: var(--text-muted); margin-top: var(--space-2);">
                        Connect to the same session as Telegram/Android for mirrored chat.
                    </p>
                </div>
            </div>

            <!-- SoLoBot Behavior -->
            <div class="modal-section">
                <h4 class="modal-section-title">ü§ñ SoLoBot Behavior</h4>
                <div class="modal-section-content">
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-title">Task Pickup Frequency</div>
                            <div class="setting-desc">How often SoLoBot checks for In Progress tasks</div>
                        </div>
                        <select id="setting-pickup-freq" onchange="updateSetting('pickupFreq', this.value)" class="select">
                            <option value="disabled">Disabled</option>
                            <option value="60000">Every 1 min</option>
                            <option value="300000">Every 5 min</option>
                            <option value="1800000">Every 30 min</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-title">Work Priority Order</div>
                            <div class="setting-desc">How tasks are prioritized</div>
                        </div>
                        <select id="setting-priority-order" onchange="updateSetting('priorityOrder', this.value)" class="select">
                            <option value="priority">P0 ‚Üí P1 ‚Üí P2</option>
                            <option value="fifo">First In, First Out</option>
                            <option value="lifo">Last In, First Out</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Dashboard Settings -->
            <div class="modal-section">
                <h4 class="modal-section-title">üìä Dashboard</h4>
                <div class="modal-section-content">
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-title">Auto-Refresh</div>
                            <div class="setting-desc">How often dashboard reloads data</div>
                        </div>
                        <select id="setting-refresh" onchange="updateSetting('refreshInterval', this.value)" class="select">
                            <option value="5000">Every 5 sec</option>
                            <option value="10000">Every 10 sec</option>
                            <option value="30000">Every 30 sec</option>
                            <option value="60000">Every 1 min</option>
                            <option value="0">Disabled</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-title">Default New Task Priority</div>
                            <div class="setting-desc">Priority for new tasks</div>
                        </div>
                        <select id="setting-default-priority" onchange="updateSetting('defaultPriority', this.value)" class="select">
                            <option value="0">P0 (Urgent)</option>
                            <option value="1">P1 (Normal)</option>
                            <option value="2">P2 (Low)</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-title">Compact Mode</div>
                            <div class="setting-desc">Denser task cards</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="setting-compact" onchange="updateSetting('compactMode', this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Visible Panels -->
            <div class="modal-section">
                <h4 class="modal-section-title">üëÅÔ∏è Visible Panels</h4>
                <div class="modal-section-content">
                    <div class="setting-row">
                        <span class="setting-title">SoLoBot Live Panel</span>
                        <input type="checkbox" id="setting-show-live" onchange="updateSetting('showLive', this.checked)" checked style="accent-color: var(--brand-red);">
                    </div>
                    <div class="setting-row">
                        <span class="setting-title">Activity Log</span>
                        <input type="checkbox" id="setting-show-activity" onchange="updateSetting('showActivity', this.checked)" checked style="accent-color: var(--brand-red);">
                    </div>
                    <div class="setting-row">
                        <span class="setting-title">Notes Panel</span>
                        <input type="checkbox" id="setting-show-notes" onchange="updateSetting('showNotes', this.checked)" checked style="accent-color: var(--brand-red);">
                    </div>
                    <div class="setting-row">
                        <span class="setting-title">Product Status</span>
                        <input type="checkbox" id="setting-show-products" onchange="updateSetting('showProducts', this.checked)" checked style="accent-color: var(--brand-red);">
                    </div>
                    <div class="setting-row">
                        <span class="setting-title">Docs Hub</span>
                        <input type="checkbox" id="setting-show-docs" onchange="updateSetting('showDocs', this.checked)" checked style="accent-color: var(--brand-red);">
                    </div>
                </div>
            </div>

            <!-- Danger Zone -->
            <div class="modal-section">
                <h4 class="modal-section-title" style="color: var(--error);">‚ö†Ô∏è Danger Zone</h4>
                <div class="danger-zone">
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-title">Reset Local Data</div>
                            <div class="setting-desc">Reload all data from server</div>
                        </div>
                        <button onclick="resetToServerState()" class="btn btn-danger" style="padding: var(--space-2) var(--space-3);">Reset</button>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-title">Clear All Data</div>
                            <div class="setting-desc">Delete all local data and tasks</div>
                        </div>
                        <button onclick="clearAllData()" class="btn btn-danger" style="padding: var(--space-2) var(--space-3);">Clear</button>
                    </div>
                </div>
            </div>

            <div style="text-align: center; font-size: 12px; color: var(--text-muted); margin-top: var(--space-4); padding-top: var(--space-4); border-top: 1px solid var(--border-default);">
                Dashboard v3.2.0 ‚Ä¢ Gateway WebSocket Chat
            </div>
        </div>
    </div>

    <!-- Archive Modal -->
    <div id="archive-modal" class="modal-overlay">
        <div class="modal modal-lg" style="max-height: 80vh; display: flex; flex-direction: column;">
            <div class="modal-header">
                <h3 class="modal-title flex items-center gap-2">
                    üì¶ Archived Tasks
                    <span id="archive-modal-count" class="badge badge-error">0</span>
                </h3>
                <div class="flex items-center gap-2">
                    <button onclick="clearArchive()" style="font-size: 12px; color: var(--error); background: none; border: none; cursor: pointer;">Clear All</button>
                    <button onclick="closeArchiveModal()" class="modal-close">‚úï</button>
                </div>
            </div>
            <div id="archive-tasks-list" style="flex: 1; overflow-y: auto; min-height: 200px;" class="space-y-2">
            </div>
        </div>
    </div>
    
    </div><!-- END app-content -->
    </div><!-- END app-layout -->

    <script src="gateway-client.js?v=3.3.0"></script>
    <script src="docs-hub-memory-files.js?v=1.1.0"></script>
    <script src="dashboard.js?v=3.3.0"></script>
    <script>
        // Page navigation
        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            const targetPage = document.getElementById('page-' + pageName);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // Update sidebar active state
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.page === pageName) {
                    item.classList.add('active');
                }
            });
            
            // If showing memory page, load files
            if (pageName === 'memory') {
                renderMemoryFilesForPage();
            }
        }
        
        // Render memory files for the Memory page
        async function renderMemoryFilesForPage(filter = '') {
            const container = document.getElementById('memory-files-grid');
            if (!container) return;
            
            container.innerHTML = '<div class="loading-state">Loading memory files...</div>';
            
            // Use the existing fetch function
            const files = await fetchMemoryFiles();
            
            if (files.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>‚ö†Ô∏è No memory files found</p></div>';
                return;
            }
            
            // Filter files
            const filtered = files.filter(file =>
                file.name.toLowerCase().includes(filter.toLowerCase()) ||
                (file.description && file.description.toLowerCase().includes(filter.toLowerCase())) ||
                (file.category && file.category.toLowerCase().includes(filter.toLowerCase()))
            );
            
            // Group by category
            const grouped = filtered.reduce((groups, file) => {
                const category = file.category || 'Other';
                if (!groups[category]) groups[category] = [];
                groups[category].push(file);
                return groups;
            }, {});
            
            // Sort categories
            const categoryOrder = ['Core Identity', 'Guides & Reference', 'Daily Logs', 'Other Documents'];
            const sortedCategories = Object.keys(grouped).sort((a, b) => {
                return categoryOrder.indexOf(a) - categoryOrder.indexOf(b);
            });
            
            // Render
            let html = '';
            sortedCategories.forEach(category => {
                html += `<div class="docs-category">`;
                html += `<h3 class="category-title">${category}</h3>`;
                html += `<div class="docs-category-grid">`;
                
                const sortedFiles = grouped[category].sort((a, b) => {
                    if (category === 'Daily Logs') return b.name.localeCompare(a.name);
                    return a.name.localeCompare(b.name);
                });
                
                sortedFiles.forEach(file => {
                    const modifiedDate = file.modified ? new Date(file.modified).toLocaleDateString() : '';
                    html += `
                        <div class="doc-card memory-file" onclick="viewMemoryFile('${file.path || file.name}')">
                            <div style="display: flex; align-items: center; gap: var(--space-3);">
                                <div class="doc-icon icon-md">üìÑ</div>
                                <div style="min-width: 0; flex: 1;">
                                    <div class="doc-title">${file.name}</div>
                                    <div class="doc-description">${file.description || ''}</div>
                                    ${modifiedDate ? `<div class="doc-meta">Modified: ${modifiedDate}</div>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += `</div></div>`;
            });
            
            container.innerHTML = html || '<div class="empty-state">No files match your search</div>';
        }
        
        // Sync memory files now (manual trigger)
        function syncMemoryFilesNow() {
            const statusEl = document.getElementById('sync-status');
            if (statusEl) {
                statusEl.className = 'sync-status syncing';
                statusEl.innerHTML = '<span class="status-dot warning"></span> Syncing...';
            }
            
            // Clear cache and reload
            if (typeof memoryFilesCache !== 'undefined') {
                memoryFilesCache = [];
                lastFetchTime = 0;
            }
            
            renderMemoryFilesForPage(document.getElementById('memory-search')?.value || '').then(() => {
                if (statusEl) {
                    statusEl.className = 'sync-status synced';
                    const now = new Date().toLocaleTimeString();
                    statusEl.innerHTML = `<span class="status-dot success"></span> Last synced: ${now}`;
                }
            });
        }
        
        // Theme toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const darkIcon = document.getElementById('theme-icon-dark');
            const lightIcon = document.getElementById('theme-icon-light');
            if (theme === 'dark') {
                darkIcon.classList.remove('hidden');
                lightIcon.classList.add('hidden');
            } else {
                darkIcon.classList.add('hidden');
                lightIcon.classList.remove('hidden');
            }
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);

        // Strict scroll containment - route scroll to element under cursor
        let currentScrollTarget = null;
        const scrollableSelectors = '.chat-messages, .activity-list, .notes-list, .terminal-output, .drop-zone';

        function updateScrollTarget(e) {
            const el = document.elementFromPoint(e.clientX, e.clientY);
            if (el) {
                currentScrollTarget = el.closest(scrollableSelectors);
            } else {
                currentScrollTarget = null;
            }
        }

        document.addEventListener('mousemove', updateScrollTarget, { passive: true });

        document.addEventListener('wheel', (e) => {
            // Find scrollable element under cursor RIGHT NOW
            const el = document.elementFromPoint(e.clientX, e.clientY);
            const scrollable = el?.closest(scrollableSelectors);

            if (scrollable) {
                // Prevent default page scroll
                e.preventDefault();
                // Manually scroll the correct container
                scrollable.scrollTop += e.deltaY;
            }
            // If not over a scrollable area, let page scroll normally
        }, { passive: false });

        window.setupScrollContainment = () => {}; // No-op now, handled globally

        // Modal helpers for the new class system
        function showModal(id) {
            document.getElementById(id).classList.add('visible');
        }
        function hideModal(id) {
            document.getElementById(id).classList.remove('visible');
        }

        // Override modal functions for new system
        const originalOpenSettingsModal = window.openSettingsModal;
        window.openSettingsModal = function() {
            showModal('settings-modal');
            if (typeof originalOpenSettingsModal === 'function') {
                // Call original to load settings
            }
        };
        window.closeSettingsModal = function() { hideModal('settings-modal'); };

        window.openAddTask = function(column) {
            window.addTaskColumn = column;
            showModal('add-task-modal');
            document.getElementById('new-task-title').focus();
        };
        window.closeAddTask = function() { hideModal('add-task-modal'); };

        window.openArchiveModal = function() { showModal('archive-modal'); renderArchive(); };
        window.closeArchiveModal = function() { hideModal('archive-modal'); };

        window.closeActionModal = function() { hideModal('task-action-modal'); };
        window.closeEditTitleModal = function() { hideModal('edit-title-modal'); };
        window.closeDeleteModal = function() { hideModal('confirm-delete-modal'); };

        // Image preview visibility
        function showImagePreview(src) {
            const container = document.getElementById('image-preview-container');
            const img = document.getElementById('image-preview');
            img.src = src;
            container.classList.add('visible');
        }
        function clearImagePreview() {
            const container = document.getElementById('image-preview-container');
            container.classList.remove('visible');
            pendingImage = null;
            document.getElementById('image-upload').value = '';
        }
    </script>
    
    <!-- Memory Files Styles -->
    <style>
        .docs-category {
            margin-bottom: var(--space-6);
        }
        
        .category-title {
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-2);
            border-bottom: 1px solid var(--border-subtle);
        }
        
        .docs-category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-4);
        }
        
        .memory-file {
            cursor: pointer;
            transition: all var(--transition-normal);
        }
        
        .memory-file:hover {
            background: var(--surface-2);
            border-color: var(--brand-red);
            transform: translateY(-1px);
        }
        
        .doc-description {
            font-size: 13px;
            color: var(--text-muted);
            line-height: 1.4;
            margin-top: var(--space-1);
        }
        
        .docs-separator {
            grid-column: 1 / -1;
            margin-top: var(--space-6);
            margin-bottom: var(--space-4);
        }
        
        .empty-state {
            text-align: center;
            color: var(--text-muted);
            padding: var(--space-10);
        }
        
        .loading-state {
            text-align: center;
            color: var(--text-muted);
            padding: var(--space-10);
            font-style: italic;
        }
        
        .doc-meta {
            font-size: 11px;
            color: var(--text-faint);
            margin-top: var(--space-1);
        }
    </style>
</body>
</html>
