<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoLoVision Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        solo: {
                            primary: '#BC2026',    // Deep Red - accent/buttons
                            secondary: '#A9B2BC',  // Cool Light Grey
                            accent: '#BC2026',     // Deep Red
                            dark: '#1B2232',       // Dark Navy Blue
                            darker: '#121820',     // Darker Navy
                            card: '#232D3F',       // Lighter Navy for cards
                            grey: '#A9B2BC',       // Cool Light Grey
                            red: '#BC2026',        // Deep Red
                            navy: '#1B2232',       // Dark Navy Blue
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .status-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #1B2232; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #A9B2BC; border-radius: 3px; }
        
        .priority-p0 { border-left: 4px solid #BC2026; }
        .priority-p1 { border-left: 4px solid #A9B2BC; }
        .priority-p2 { border-left: 4px solid #3b82f6; }
        
        /* Task card hover effects */
        .task-card:hover .task-quick-actions {
            opacity: 1;
            transform: translateY(-50%) translateX(4px);
        }
        .task-quick-actions {
            transition: all 0.2s ease;
        }
        
        /* Checkbox styling */
        input[type="checkbox"] {
            accent-color: #BC2026;
        }
        
        /* Selected task glow */
        .task-card.ring-2 {
            box-shadow: 0 0 0 2px rgba(188, 32, 38, 0.3);
        }
        
        /* Bulk action bar animation */
        #bulk-action-bar {
            animation: slideUp 0.2s ease;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translate(-50%, 20px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }
    </style>
</head>
<body class="bg-solo-darker text-gray-100 min-h-screen">
    
    <!-- Header -->
    <header class="bg-solo-dark border-b border-solo-grey/20 px-6 py-4">
        <div class="flex items-center justify-between max-w-7xl mx-auto">
            <div class="flex items-center gap-4">
                <div class="text-2xl font-bold text-white">
                    SoLoVision Command Center
                </div>
            </div>
            
            <!-- AI Status Panel -->
            <div class="flex items-center gap-6">
                <div class="flex items-center gap-3 bg-solo-card px-4 py-2 rounded-lg">
                    <div id="status-indicator" class="w-3 h-3 rounded-full bg-green-500 status-pulse"></div>
                    <span id="status-text" class="text-sm font-medium">IDLE</span>
                </div>
                <div class="text-sm text-solo-grey">
                    <span class="text-solo-grey/70">Provider:</span> 
                    <span id="provider-name" class="text-white">anthropic</span>
                </div>
                <div class="text-sm text-solo-grey">
                    <span class="text-solo-grey/70">Model:</span> 
                    <span id="model-name" class="text-white">opus 4.5</span>
                </div>
                <div id="current-task" class="text-sm text-solo-grey max-w-xs truncate hidden">
                    <span class="text-solo-grey/70">Task:</span>
                    <span id="task-name" class="text-white"></span>
                </div>
            </div>
        </div>
    </header>

    <!-- Sub-agent Banner (hidden by default) -->
    <div id="subagent-banner" class="bg-solo-secondary/20 border-b border-solo-secondary/30 px-6 py-2 hidden">
        <div class="max-w-7xl mx-auto flex items-center gap-2 text-sm">
            <svg class="w-4 h-4 text-solo-secondary animate-spin" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span class="text-solo-secondary font-medium">Sub-agent active:</span>
            <span id="subagent-task" class="text-white">Researching...</span>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto p-6">
        
        <!-- SoLoBot Console -->
        
        <!-- Kanban Board -->
        <section class="mb-8">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold flex items-center gap-2">
                    <svg class="w-5 h-5 text-solo-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                    Task Board
                </h2>
                <div class="flex items-center gap-2">
                    <button onclick="openArchiveModal()" class="text-sm text-solo-grey hover:text-white flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-solo-card transition">
                        üì¶ Archive <span id="archive-badge" class="text-xs bg-solo-red/20 text-solo-red px-2 py-0.5 rounded-full hidden">0</span>
                    </button>
                    <button onclick="syncFromVPS()" class="text-sm text-solo-grey hover:text-white flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-solo-card transition" title="Pull latest state from VPS">
                        üîÑ Sync
                    </button>
                    <button onclick="openSettingsModal()" class="text-sm text-solo-grey hover:text-white flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-solo-card transition">
                        ‚öôÔ∏è Settings
                    </button>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                
                <!-- To-Do Column -->
                <div class="bg-solo-card rounded-lg p-4">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-medium text-white flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-slate-500"></span>
                            To-Do
                            <span id="todo-count" class="text-xs bg-slate-600 px-2 py-0.5 rounded-full">0</span>
                        </h3>
                        <button onclick="openAddTask('todo')" class="text-solo-grey/70 hover:text-white transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="todo-tasks" class="drop-zone space-y-2 min-h-[200px] rounded-lg transition-all"
                         ondragover="handleDragOver(event)"
                         ondragenter="handleDragEnter(event, 'todo')"
                         ondragleave="handleDragLeave(event, 'todo')"
                         ondrop="handleDrop(event, 'todo')">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>

                <!-- In Progress Column -->
                <div class="bg-solo-card rounded-lg p-4">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-medium text-white flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-yellow-500"></span>
                            In Progress
                            <span id="progress-count" class="text-xs bg-slate-600 px-2 py-0.5 rounded-full">0</span>
                        </h3>
                    </div>
                    <div id="progress-tasks" class="drop-zone space-y-2 min-h-[200px] rounded-lg transition-all"
                         ondragover="handleDragOver(event)"
                         ondragenter="handleDragEnter(event, 'progress')"
                         ondragleave="handleDragLeave(event, 'progress')"
                         ondrop="handleDrop(event, 'progress')">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>

                <!-- Done Column -->
                <div class="bg-solo-card rounded-lg p-4">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-medium text-white flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                            Done
                            <span id="done-count" class="text-xs bg-slate-600 px-2 py-0.5 rounded-full">0</span>
                        </h3>
                        <button onclick="clearDone()" class="text-solo-grey/70 hover:text-white transition text-xs">
                            Clear
                        </button>
                    </div>
                    <div id="done-tasks" class="drop-zone space-y-2 min-h-[200px] max-h-[400px] overflow-y-auto scrollbar-thin rounded-lg transition-all"
                         ondragover="handleDragOver(event)"
                         ondragenter="handleDragEnter(event, 'done')"
                         ondragleave="handleDragLeave(event, 'done')"
                         ondrop="handleDrop(event, 'done')">
                        <!-- Tasks will be inserted here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Row 1: Terminal + Activity Log side by side -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- Terminal -->
            <div class="bg-black rounded-xl border border-solo-grey/20 overflow-hidden" id="console-section">
                <div class="bg-slate-800 px-4 py-2 flex items-center justify-between border-b border-solo-grey/20">
                    <div class="flex items-center gap-3">
                        <div class="flex gap-1.5">
                            <div class="w-3 h-3 rounded-full bg-red-500"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        </div>
                        <span class="text-sm text-solo-grey font-mono">SoLoBot Terminal</span>
                        <span id="console-status-badge" class="text-xs px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 font-mono">IDLE</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="clearConsole()" class="text-xs text-solo-grey/70 hover:text-white px-2 py-1 rounded hover:bg-solo-card transition">Clear</button>
                        <button onclick="toggleConsoleExpand()" class="text-xs text-solo-grey/70 hover:text-white px-2 py-1 rounded hover:bg-solo-card transition" id="console-expand-btn">Expand</button>
                    </div>
                </div>
                <div id="console-output" class="p-4 font-mono text-sm h-[250px] overflow-y-auto scrollbar-thin bg-solo-darker" style="font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;">
                    <div class="text-green-400">$ solobot --init</div>
                    <div class="text-solo-grey">Ready for commands...</div>
                </div>
            </div>

            <!-- Activity Log -->
            <div class="bg-solo-card rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                    <svg class="w-5 h-5 text-solo-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Activity Log
                </h2>
                <div id="activity-log" class="space-y-2 h-[250px] overflow-y-auto scrollbar-thin">
                    <!-- Activity entries will be inserted here -->
                </div>
            </div>
        </section>

        <!-- Row 2: Chat + Notes side by side -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Chat -->
            <div class="bg-solo-card rounded-lg overflow-hidden">
                <div class="p-4 border-b border-solo-grey/20">
                    <div class="flex items-center justify-between">
                        <h2 class="text-lg font-semibold flex items-center gap-2">
                            <svg class="w-5 h-5 text-solo-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                            </svg>
                            Chat with SoLoBot
                        </h2>
                        <div class="flex items-center gap-2">
                            <span id="gateway-status-dot" class="w-2 h-2 rounded-full bg-gray-500"></span>
                            <span id="gateway-status" class="text-xs text-solo-grey">Disconnected</span>
                        </div>
                    </div>
                </div>
                <div id="chat-messages" class="h-[300px] overflow-y-auto p-4 scrollbar-thin bg-solo-darker">
                    <div class="text-solo-grey/70 text-sm text-center py-4">üîå Connect to Gateway in Settings to start chatting</div>
                </div>
                <!-- Image Preview Area -->
                <div id="image-preview-container" class="hidden border-t border-solo-grey/20 p-2 bg-solo-dark">
                    <div class="relative inline-block">
                        <img id="image-preview" class="max-h-32 rounded-lg" />
                        <button onclick="clearImagePreview()" class="absolute -top-2 -right-2 bg-solo-red text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600">‚úï</button>
                    </div>
                </div>
                
                <!-- Chat Input -->
                <div class="border-t border-solo-grey/20 p-3 bg-solo-dark">
                    <div class="flex gap-2 items-center">
                        <!-- Image Upload Button -->
                        <label class="cursor-pointer text-solo-grey hover:text-solo-red transition p-2">
                            <input type="file" id="image-upload" accept="image/*" class="hidden" onchange="handleImageSelect(event)">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </label>
                        <input type="text" id="chat-input" placeholder="Type a message..."
                               class="flex-1 bg-solo-darker border border-solo-grey/30 rounded-lg px-4 py-2 text-sm text-white placeholder-solo-grey focus:outline-none focus:border-solo-red transition"
                               onkeypress="if(event.key==='Enter')sendChatMessage()"
                               onpaste="handlePaste(event)">
                        <button onclick="sendChatMessage()" class="bg-solo-red hover:bg-solo-red/80 text-white px-4 py-2 rounded-lg text-sm font-medium transition">Send</button>
                    </div>
                </div>
            </div>

            <!-- Notes -->
            <div class="bg-solo-card rounded-lg p-4">
                <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                    <svg class="w-5 h-5 text-solo-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                    Notes for SoLoBot
                </h2>
                <div class="mb-4">
                    <div class="flex gap-2">
                        <input type="text" id="note-input" placeholder="Leave a note for SoLoBot..." 
                               class="flex-1 bg-solo-dark border border-solo-grey/30 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-solo-red transition">
                        <button onclick="addNote()" class="bg-solo-red hover:bg-solo-red/80 text-white px-4 py-2 rounded-lg text-sm font-medium transition">Send</button>
                    </div>
                </div>
                <div id="notes-list" class="space-y-2 h-[200px] overflow-y-auto scrollbar-thin">
                    <!-- Notes will be inserted here -->
                </div>
            </div>
        </section>

        <!-- Product Status Cards -->
        <section class="mb-8">
            <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-solo-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                </svg>
                Product Status
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                
                <div class="bg-solo-card rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-medium">SoLoLink</span>
                        <span class="w-3 h-3 rounded-full bg-green-500"></span>
                    </div>
                    <p class="text-sm text-solo-grey">Link/widget tool</p>
                    <p class="text-xs text-solo-grey/70 mt-2">Last update: Active</p>
                </div>

                <div class="bg-solo-card rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-medium">SoLoRecall</span>
                        <span class="w-3 h-3 rounded-full bg-yellow-500"></span>
                    </div>
                    <p class="text-sm text-solo-grey">AI productivity app</p>
                    <p class="text-xs text-solo-grey/70 mt-2">Last update: In dev</p>
                </div>

                <div class="bg-solo-card rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-medium">SoLoVoice</span>
                        <span class="w-3 h-3 rounded-full bg-green-500"></span>
                    </div>
                    <p class="text-sm text-solo-grey">Voice/audio tool</p>
                    <p class="text-xs text-solo-grey/70 mt-2">Last update: Active</p>
                </div>

                <div class="bg-solo-card rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-medium">SoLoFamilyPlan</span>
                        <span class="w-3 h-3 rounded-full bg-green-500"></span>
                    </div>
                    <p class="text-sm text-solo-grey">Family organizer</p>
                    <p class="text-xs text-solo-grey/70 mt-2">Last update: Stable</p>
                </div>
            </div>
        </section>

        <!-- Docs Hub -->
        <section>
            <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-solo-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                Docs Hub
                <input type="text" id="docs-search" placeholder="Search docs..." 
                       class="ml-auto bg-solo-dark border border-solo-grey/30 rounded-lg px-3 py-1 text-sm w-48 focus:outline-none focus:border-solo-red transition">
            </h2>
            <div id="docs-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Docs will be inserted here -->
            </div>
        </section>

    </main>

    <!-- Add Task Modal -->
    <div id="add-task-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-solo-card rounded-lg p-6 w-full max-w-md mx-4">
            <h3 class="text-lg font-semibold mb-4">Add New Task</h3>
            <input type="text" id="new-task-title" placeholder="Task title..." 
                   class="w-full bg-solo-dark border border-solo-grey/30 rounded-lg px-4 py-2 mb-4 focus:outline-none focus:border-solo-red transition">
            <div class="flex gap-2 mb-4">
                <button onclick="setTaskPriority(0)" id="priority-btn-0" class="flex-1 py-2 rounded-lg border-2 border-red-500 text-red-500 hover:bg-red-500/20 transition">P0</button>
                <button onclick="setTaskPriority(1)" id="priority-btn-1" class="flex-1 py-2 rounded-lg border-2 border-yellow-500 text-yellow-500 hover:bg-yellow-500/20 transition">P1</button>
                <button onclick="setTaskPriority(2)" id="priority-btn-2" class="flex-1 py-2 rounded-lg border-2 border-blue-500 text-blue-500 hover:bg-blue-500/20 transition">P2</button>
            </div>
            <div class="flex gap-2">
                <button onclick="closeAddTask()" class="flex-1 py-2 rounded-lg border border-solo-grey/30 hover:bg-solo-card transition">Cancel</button>
                <button onclick="submitTask()" class="flex-1 py-2 rounded-lg bg-solo-red hover:bg-solo-red/80 text-white transition">Add Task</button>
            </div>
        </div>
    </div>

    <!-- Task Action Modal -->
    <div id="task-action-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-solo-card rounded-xl p-6 w-full max-w-sm mx-4 shadow-2xl border border-solo-grey/30">
            <div class="flex items-start justify-between mb-4">
                <div>
                    <h3 class="text-lg font-semibold text-white">Task Actions</h3>
                    <p id="action-modal-task-title" class="text-sm text-solo-grey mt-1 truncate max-w-[250px]"></p>
                </div>
                <button onclick="closeActionModal()" class="text-solo-grey/70 hover:text-white transition p-1">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="space-y-2 mb-4">
                <button id="action-move-todo" onclick="modalMoveTask('todo')" class="w-full text-left px-4 py-3 rounded-lg bg-solo-dark hover:bg-solo-card transition flex items-center gap-3">
                    <span class="w-3 h-3 rounded-full bg-slate-500"></span>
                    <span>Move to To-Do</span>
                </button>
                <button id="action-move-progress" onclick="modalMoveTask('progress')" class="w-full text-left px-4 py-3 rounded-lg bg-solo-dark hover:bg-solo-card transition flex items-center gap-3">
                    <span class="w-3 h-3 rounded-full bg-yellow-500"></span>
                    <span>Move to In Progress</span>
                </button>
                <button id="action-move-done" onclick="modalMoveTask('done')" class="w-full text-left px-4 py-3 rounded-lg bg-solo-dark hover:bg-solo-card transition flex items-center gap-3">
                    <span class="w-3 h-3 rounded-full bg-green-500"></span>
                    <span>Move to Done</span>
                </button>
                <button id="action-move-archive" onclick="modalMoveTask('archive')" class="w-full text-left px-4 py-3 rounded-lg bg-solo-dark hover:bg-solo-card transition flex items-center gap-3">
                    <span class="w-3 h-3 rounded-full bg-solo-red"></span>
                    <span>üì¶ Archive</span>
                </button>
            </div>
            
            <div class="border-t border-solo-grey/30 pt-4 space-y-2">
                <button onclick="modalEditTitle()" class="w-full text-left px-4 py-3 rounded-lg bg-solo-dark hover:bg-solo-card transition flex items-center gap-3">
                    <span>‚úèÔ∏è</span>
                    <span>Edit Title</span>
                </button>
                <button onclick="modalCyclePriority()" class="w-full text-left px-4 py-3 rounded-lg bg-solo-dark hover:bg-solo-card transition flex items-center gap-3">
                    <span>üîÑ</span>
                    <span id="action-priority-text">Change Priority (P1)</span>
                </button>
            </div>
            
            <div class="border-t border-solo-grey/30 pt-4 mt-4">
                <button onclick="modalDeleteTask()" class="w-full text-left px-4 py-3 rounded-lg bg-red-500/10 hover:bg-red-500/20 text-red-400 transition flex items-center gap-3">
                    <span>üóëÔ∏è</span>
                    <span>Delete Task</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Title Modal -->
    <div id="edit-title-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-solo-card rounded-xl p-6 w-full max-w-sm mx-4 shadow-2xl border border-solo-grey/30">
            <h3 class="text-lg font-semibold mb-4">Edit Task Title</h3>
            <input type="text" id="edit-title-input" placeholder="Task title..." 
                   class="w-full bg-solo-dark border border-solo-grey/30 rounded-lg px-4 py-3 mb-4 focus:outline-none focus:border-solo-red transition">
            <div class="flex gap-2">
                <button onclick="closeEditTitleModal()" class="flex-1 py-2 rounded-lg border border-solo-grey/30 hover:bg-solo-card transition">Cancel</button>
                <button onclick="saveEditedTitle()" class="flex-1 py-2 rounded-lg bg-solo-red hover:bg-solo-red/80 text-white transition">Save</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete Modal -->
    <div id="confirm-delete-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-solo-card rounded-xl p-6 w-full max-w-sm mx-4 shadow-2xl border border-solo-grey/30">
            <h3 class="text-lg font-semibold mb-2">Delete Task?</h3>
            <p id="delete-modal-task-title" class="text-sm text-solo-grey mb-6 truncate"></p>
            <div class="flex gap-2">
                <button onclick="closeDeleteModal()" class="flex-1 py-2 rounded-lg border border-solo-grey/30 hover:bg-solo-card transition">Cancel</button>
                <button onclick="confirmDeleteTask()" class="flex-1 py-2 rounded-lg bg-red-600 hover:bg-red-500 transition">Delete</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-solo-card rounded-xl p-6 w-full max-w-lg mx-4 shadow-2xl border border-solo-grey/30 max-h-[85vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold flex items-center gap-2">
                    ‚öôÔ∏è Dashboard Settings
                </h3>
                <button onclick="closeSettingsModal()" class="text-solo-grey/70 hover:text-white transition p-1">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <!-- Gateway Connection -->
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-white mb-3 flex items-center gap-2">
                    üîå Gateway Connection
                </h4>
                <div class="space-y-4 bg-solo-dark rounded-lg p-4">
                    <div class="flex items-center gap-2 mb-3">
                        <span id="settings-gateway-dot" class="w-3 h-3 rounded-full bg-gray-500"></span>
                        <span id="settings-gateway-status" class="text-sm text-solo-grey">Disconnected</span>
                    </div>
                    <div>
                        <label class="text-xs text-solo-grey/70 mb-1 block">Gateway Host</label>
                        <input type="text" id="gateway-host" placeholder="e.g., moltbot.local or 192.168.1.100"
                               class="w-full bg-solo-card border border-solo-grey/30 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-solo-red">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-xs text-solo-grey/70 mb-1 block">Port</label>
                            <input type="number" id="gateway-port" placeholder="443" value="443"
                                   class="w-full bg-solo-card border border-solo-grey/30 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-solo-red">
                        </div>
                        <div>
                            <label class="text-xs text-solo-grey/70 mb-1 block">Session Key</label>
                            <input type="text" id="gateway-session" placeholder="main" value="main"
                                   class="w-full bg-solo-card border border-solo-grey/30 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-solo-red">
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-solo-grey/70 mb-1 block">Token (optional)</label>
                        <input type="password" id="gateway-token" placeholder="Gateway auth token"
                               class="w-full bg-solo-card border border-solo-grey/30 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-solo-red">
                    </div>
                    <div class="flex gap-2 pt-2">
                        <button id="gateway-connect-btn" onclick="connectToGateway()"
                                class="flex-1 bg-green-600 hover:bg-green-500 px-4 py-2 rounded-lg text-sm font-medium transition">Connect</button>
                        <button id="gateway-disconnect-btn" onclick="disconnectFromGateway()"
                                class="flex-1 bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg text-sm font-medium transition hidden">Disconnect</button>
                    </div>
                    <p class="text-xs text-solo-grey/70 mt-2">
                        Connect to the same session as Telegram/Android for mirrored chat.
                    </p>
                </div>
            </div>

            <!-- SoLoBot Settings -->
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-white mb-3 flex items-center gap-2">
                    ü§ñ SoLoBot Behavior
                </h4>
                <div class="space-y-4 bg-solo-dark rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-white">Task Pickup Frequency</div>
                            <div class="text-xs text-solo-grey/70">How often SoLoBot checks for In Progress tasks</div>
                        </div>
                        <select id="setting-pickup-freq" onchange="updateSetting('pickupFreq', this.value)" class="bg-solo-card border border-solo-grey/30 rounded-lg px-3 py-1.5 text-sm">
                            <option value="disabled">Disabled</option>
                            <option value="60000">Every 1 min</option>
                            <option value="300000">Every 5 min</option>
                            <option value="1800000">Every 30 min</option>
                        </select>
                    </div>
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-white">Work Priority Order</div>
                            <div class="text-xs text-solo-grey/70">How tasks are prioritized</div>
                        </div>
                        <select id="setting-priority-order" onchange="updateSetting('priorityOrder', this.value)" class="bg-solo-card border border-solo-grey/30 rounded-lg px-3 py-1.5 text-sm">
                            <option value="priority">P0 ‚Üí P1 ‚Üí P2</option>
                            <option value="fifo">First In, First Out</option>
                            <option value="lifo">Last In, First Out</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Dashboard Settings -->
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-white mb-3 flex items-center gap-2">
                    üìä Dashboard
                </h4>
                <div class="space-y-4 bg-solo-dark rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-white">Auto-Refresh</div>
                            <div class="text-xs text-solo-grey/70">How often dashboard reloads data</div>
                        </div>
                        <select id="setting-refresh" onchange="updateSetting('refreshInterval', this.value)" class="bg-solo-card border border-solo-grey/30 rounded-lg px-3 py-1.5 text-sm">
                            <option value="5000">Every 5 sec</option>
                            <option value="10000">Every 10 sec</option>
                            <option value="30000">Every 30 sec</option>
                            <option value="60000">Every 1 min</option>
                            <option value="0">Disabled</option>
                        </select>
                    </div>
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-white">Default New Task Priority</div>
                            <div class="text-xs text-solo-grey/70">Priority for new tasks</div>
                        </div>
                        <select id="setting-default-priority" onchange="updateSetting('defaultPriority', this.value)" class="bg-solo-card border border-solo-grey/30 rounded-lg px-3 py-1.5 text-sm">
                            <option value="0">P0 (Urgent)</option>
                            <option value="1">P1 (Normal)</option>
                            <option value="2">P2 (Low)</option>
                        </select>
                    </div>
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-white">Compact Mode</div>
                            <div class="text-xs text-solo-grey/70">Denser task cards</div>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="setting-compact" onchange="updateSetting('compactMode', this.checked)" class="sr-only peer">
                            <div class="w-11 h-6 bg-slate-600 peer-focus:ring-2 peer-focus:ring-solo-primary rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-solo-primary"></div>
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Show/Hide Panels -->
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-white mb-3 flex items-center gap-2">
                    üëÅÔ∏è Visible Panels
                </h4>
                <div class="space-y-3 bg-solo-dark rounded-lg p-4">
                    <label class="flex items-center justify-between cursor-pointer">
                        <span class="text-sm text-white">SoLoBot Live Panel</span>
                        <input type="checkbox" id="setting-show-live" onchange="updateSetting('showLive', this.checked)" checked class="w-4 h-4 accent-solo-primary">
                    </label>
                    <label class="flex items-center justify-between cursor-pointer">
                        <span class="text-sm text-white">Activity Log</span>
                        <input type="checkbox" id="setting-show-activity" onchange="updateSetting('showActivity', this.checked)" checked class="w-4 h-4 accent-solo-primary">
                    </label>
                    <label class="flex items-center justify-between cursor-pointer">
                        <span class="text-sm text-white">Notes Panel</span>
                        <input type="checkbox" id="setting-show-notes" onchange="updateSetting('showNotes', this.checked)" checked class="w-4 h-4 accent-solo-primary">
                    </label>
                    <label class="flex items-center justify-between cursor-pointer">
                        <span class="text-sm text-white">Product Status</span>
                        <input type="checkbox" id="setting-show-products" onchange="updateSetting('showProducts', this.checked)" checked class="w-4 h-4 accent-solo-primary">
                    </label>
                    <label class="flex items-center justify-between cursor-pointer">
                        <span class="text-sm text-white">Docs Hub</span>
                        <input type="checkbox" id="setting-show-docs" onchange="updateSetting('showDocs', this.checked)" checked class="w-4 h-4 accent-solo-primary">
                    </label>
                </div>
            </div>
            
            <!-- Danger Zone -->
            <div>
                <h4 class="text-sm font-semibold text-red-400 mb-3 flex items-center gap-2">
                    ‚ö†Ô∏è Danger Zone
                </h4>
                <div class="space-y-3 bg-red-500/10 rounded-lg p-4 border border-red-500/20">
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-white">Reset Local Data</div>
                            <div class="text-xs text-solo-grey/70">Reload all data from server</div>
                        </div>
                        <button onclick="resetToServerState()" class="px-3 py-1.5 text-sm bg-red-600 hover:bg-red-500 rounded-lg transition">Reset</button>
                    </div>
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="text-sm text-white">Clear All Data</div>
                            <div class="text-xs text-solo-grey/70">Delete all local data and tasks</div>
                        </div>
                        <button onclick="clearAllData()" class="px-3 py-1.5 text-sm bg-red-600 hover:bg-red-500 rounded-lg transition">Clear</button>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 pt-4 border-t border-solo-grey/30 text-center text-xs text-solo-grey/70">
                Dashboard v3.1.0 ‚Ä¢ Gateway WebSocket Chat
            </div>
        </div>
    </div>

    <!-- Archive Modal -->
    <div id="archive-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-solo-card rounded-xl p-6 w-full max-w-2xl mx-4 shadow-2xl border border-solo-grey/30 max-h-[80vh] flex flex-col">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold flex items-center gap-2">
                    üì¶ Archived Tasks
                    <span id="archive-modal-count" class="text-xs bg-solo-red/20 text-solo-red px-2 py-0.5 rounded-full">0</span>
                </h3>
                <div class="flex items-center gap-2">
                    <button onclick="clearArchive()" class="text-sm text-red-400 hover:text-red-300 px-3 py-1 rounded hover:bg-red-500/10 transition">Clear All</button>
                    <button onclick="closeArchiveModal()" class="text-solo-grey/70 hover:text-white transition p-1">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div id="archive-tasks-list" class="flex-1 overflow-y-auto space-y-2 min-h-[200px]">
                <!-- Archived tasks will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-solo-dark border-t border-solo-grey/20 px-6 py-3 mt-8">
        <div class="max-w-7xl mx-auto flex items-center justify-between text-sm text-solo-grey/70">
            <span>SoLoVision LLC ¬© 2026</span>
            <span class="flex items-center gap-2">
                <span class="flex items-center gap-1">
                    <span id="live-dot" class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                    <span class="text-green-400">LIVE</span>
                </span>
                <span class="text-gray-600">|</span>
                <span>Last sync: <span id="last-sync" class="text-solo-grey">--:--</span></span>
            </span>
        </div>
    </footer>

    <script src="gateway-client.js?v=3.1.0"></script>
    <script src="dashboard.js?v=3.1.0"></script>
</body>
</html>
